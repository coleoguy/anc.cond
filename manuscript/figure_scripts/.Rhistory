probs2 <- vector()
for(i in 1:10){
probs2[i] <- round(sum(y[(200 * (i - 1) + 1):(200 * i)] <= .025, na.rm = T) /
sum(!is.na(y[(200 * (i - 1) + 1):(200 * i)])),digits = 2)
}
results <- as.data.frame(matrix(,20,3))
colnames(results) <- c("value", "scaling.factor", "type")
results[, 1] <- c(probs2,probs)
results[, 2] <- c(1:10,1:10)
x <- factor(c("bidirectional false positive",
rep("bidirectional power",9),
"unidirectional false positive",
rep("unidirectional power", 9)))
x <- factor(x, levels(x)[c(2,4,1,3)])
results[, 3] <- x
ggplot(results, aes(y=value, x=scaling.factor, group=type, colour=type, shape=type)) +
geom_hline(yintercept = .05, linetype="dashed") +
geom_point(stat="identity", size=4, alpha=.8) +
geom_line() +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5), legend.text=element_text(size=rel(0.6))) +
scale_size(range=c(1, 4)) +
xlab("scaling factor") +
ylab("percent significant") +
scale_colour_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c("#377eb8","#e41a1c","#0d0101","#0d0101")) +
scale_shape_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c(16,16,0,4))
# export at 6.5x4
##### Fig 3 #####
load('../../results/UnidirectionalTaxaFPResults.RData')
load('../../results/UnidirectionalTaxaPowerResults.RData')
x <- seq(from=20, to=200, by=20)
y <- vector()
for(i in 1:10){
y <- c(y, taxa.uni.power.results[1:100, i])
}
probs <- vector()
for(i in 1:10){
probs[i] <- sum(taxa.uni.power.results[1:100, i] <= .05)
}
probsfp <- vector()
for(i in 1:10){
probsfp[i] <- sum(taxa.uni.fp.results[1:100, i] <= .05)
}
load('../../results/BidirectionalTaxaPowerResults.RData')
load('../../results/BidirectionalTaxaFPResults.RData')
y <- vector()
for(i in 1:10){
for(j in 1:10){
for(i in 1:100){
y[2 * (100 * (j - 1) + i - 1) + 1] <- as.numeric(gsub(",.*", "",taxa.bi.power.results[i,j]))
y[2 * (100 * (j - 1) + i - 1) + 2] <- as.numeric(substr(taxa.bi.power.results[i,j], (nchar(gsub(",.*", "",taxa.bi.power.results[i,j])) + 2),
nchar(taxa.bi.power.results[i,j])))
}
}
}
biprobs <- vector()
for(i in 1:10){
biprobs[i] <-
round(100 * sum(y[(200 * (i - 1) + 1):(200 * i)] <= .025, na.rm = T) / sum(!is.na(y[(200 * (i - 1) + 1):(200 * i)])),
digits = 0)
}
y <- vector()
for(i in 1:10){
for(j in 1:10){
for(i in 1:100){
y[2 * (100 * (j - 1) + i - 1) + 1] <- as.numeric(gsub(",.*", "",taxa.bi.fp.results[i,j]))
y[2 * (100 * (j - 1) + i - 1) + 2] <- as.numeric(substr(taxa.bi.fp.results[i,j], (nchar(gsub(",.*", "",taxa.bi.fp.results[i,j])) + 2),
nchar(taxa.bi.fp.results[i,j])))
}
}
}
biprobsfp <- vector()
for(i in 1:10){
biprobsfp[i] <- round(100 * sum(y[(200 * (i - 1) + 1):(200 * i)] <= .025, na.rm = T) /
sum(!is.na(y[(200 * (i - 1) + 1):(200 * i)])),
digits = 0)
}
up <- probs/100
bp <- biprobs/100
ufp <- probsfp/100
bfp <- biprobsfp/100
results <- as.data.frame(matrix(,40,3))
colnames(results) <- c("value", "taxa.number", "type")
results[, 1] <- c(up,bp,ufp,bfp)
results[, 2] <- rep(c(20,40,60,80,100,120,140,160,180,200), 4)
x <- factor(c(rep("unidirectional power", 10),
rep("bidirectional power",10),
rep("unidirectional false positive",10),
rep("bidirectional false positive", 10)))
x <- factor(x, levels(x)[c(2,4,1,3)])
results[, 3] <- x
ggplot(results, aes(y=value, x=taxa.number, group=type, colour=type, shape=type)) +
geom_hline(yintercept = .05, linetype="dashed") +
geom_point(stat="identity", size=4, alpha=.8) +
geom_line() +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5), legend.text=element_text(size=rel(0.6))) +
scale_size(range=c(1, 4)) +
xlab("number of taxa") +
ylab("percent significant") +
scale_colour_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c("#377eb8","#e41a1c","#377eb8","#e41a1c")) +
scale_shape_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c(16,16,1,1))
# export at 6.5x4
View(pval.array)
colSums(pval.array)
results
row.names(results)
results <- as.data.frame(matrix(,2,3))
row.names(results) <- c("power","false.positive")
colnames(results) <- c("pagel","thresh","ancond")
load("../../results/PagelThreshPower.RData")
results[1,1:3] <- c(colSums(pval.array), 50)
results
colSums(pval.array)
results <- as.data.frame(matrix(,2,3))
row.names(results) <- c("power","false.positive")
colnames(results) <- c("pagel","thresh","ancond")
load("../../results/PagelThreshPower.RData")
results[1,1:3] <- c(colSums(pval.array), 50)
results
colSums(pval.array)
load("../../results/PagelThreshFP.RData")
results[2,1:3] <- c(colSums(pval.array), 6)
results
colSums(pval.array)
res <- as.data.frame(cbind(unlist(results),
rep(c("power","false positive"), times=3),
rep(c("Pagel's","Threshold","Ancestral condition"), each=2)))
colnames(res) <- c("pos","type","test")
res$pos <- as.numeric(as.character(res$pos))
res
ggplot(res, aes(y=pos, x=as.factor(test))) +
geom_bar(fill=rep(c("#e41a1c", "#4f8cc0", "#60b45c"),times=2), stat="identity",alpha=.8) +
facet_grid(. ~ type) +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
text=element_text(family="sans", face="plain", color="#000000", size=15, hjust=0.5, vjust=0.5)) +
xlab("") +
ylab("rate")
scaling.uni.results
library(ggplot2)
par(mfrow = c(1,1), mar = c(5,4,4,2) + .1)
load('../../results/UnidirectionalScalingAnalysisResults.RData')
probs <- vector()
for(i in 1:10){
probs[i] <- sum(scaling.uni.results[1:100, i] <= .05) / 100
}
scaling.uni.results
load('../../results/BidirectionalScalingAnalysisResults.RData')
scaling.bi.results
nchar(scaling.bi.results)
y
vector()
probs2 <- vector()
for(i in 1:10){
probs2[i] <- round(sum(y[(200 * (i - 1) + 1):(200 * i)] <= .025, na.rm = T) /
sum(!is.na(y[(200 * (i - 1) + 1):(200 * i)])),digits = 2)
}
i
probs2
View(probs2)
results <- as.data.frame(matrix(,20,3))
colnames(results) <- c("value", "scaling.factor", "type")
results[, 1] <- c(probs2,probs)
results[, 2] <- c(1:10,1:10)
x <- factor(c("bidirectional false positive",
rep("bidirectional power",9),
"unidirectional false positive",
rep("unidirectional power", 9)))
x <- factor(x, levels(x)[c(2,4,1,3)])
results[, 3] <- x
results <- as.data.frame(matrix(,20,3))
colnames(results) <- c("value", "scaling.factor", "type")
results[, 1] <- c(probs2,probs)
results[, 2] <- c(1:10,1:10)
results
x <- factor(c("bidirectional false positive",
rep("bidirectional power",9),
"unidirectional false positive",
rep("unidirectional power", 9)))
x <- factor(x, levels(x)[c(2,4,1,3)])
results[, 3] <- x
results
ggplot(results, aes(y=value, x=scaling.factor, group=type, colour=type, shape=type)) +
geom_hline(yintercept = .05, linetype="dashed") +
geom_point(stat="identity", size=4, alpha=.8) +
geom_line() +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5), legend.text=element_text(size=rel(0.6))) +
scale_size(range=c(1, 4)) +
xlab("scaling factor") +
ylab("percent significant") +
scale_colour_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c("#377eb8","#e41a1c","#0d0101","#0d0101")) +
scale_shape_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c(16,16,0,4))
results <- as.data.frame(matrix(,20,3))
colnames(results) <- c("value", "scaling.factor", "type")
results[, 1] <- c(probs2,probs)
results[, 2] <- c(1:10,1:10)
x <- factor(c("bidirectional false positive",
rep("bidirectional power",9),
"unidirectional false positive",
rep("unidirectional power", 9)))
x <- factor(x, levels(x)[c(2,4,1,3)])
results[, 3] <- x
ggplot(results, aes(y=value, x=scaling.factor, group=type, colour=type, shape=type)) +
geom_hline(yintercept = .05, linetype="dashed") +
geom_point(stat="identity", size=4, alpha=.8) +
geom_line() +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5), legend.text=element_text(size=rel(0.6))) +
scale_size(range=c(1, 4)) +
xlab("scaling factor") +
ylab("percent significant") +
scale_colour_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c("#377eb8","#e41a1c","#0d0101","#0d0101")) +
scale_shape_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c(16,16,0,4))
library(ggplot2)
par(mfrow = c(1,1), mar = c(5,4,4,2) + .1)
load('../../results/UnidirectionalScalingAnalysisResults.RData')
probs <- vector()
for(i in 1:10){
probs[i] <- sum(scaling.uni.results[1:100, i] <= .05) / 100
}
x <- rep(1:10)
load('../../results/BidirectionalScalingAnalysisResults.RData')
y <- vector()
for(j in 1:10){
for(i in 1:100){
y[2 * (100 * (j - 1) + i - 1) + 1] <- as.numeric(gsub(",.*", "",scaling.bi.results[i,j]))
y[2 * (100 * (j - 1) + i - 1) + 2] <- as.numeric(substr(scaling.bi.results[i,j], (nchar(gsub(",.*", "",scaling.bi.results[i,j])) + 2),
nchar(scaling.bi.results[i,j])))
}
}
probs2 <- vector()
for(i in 1:10){
probs2[i] <- round(sum(y[(200 * (i - 1) + 1):(200 * i)] <= .025, na.rm = T) /
sum(!is.na(y[(200 * (i - 1) + 1):(200 * i)])),digits = 2)
}
results <- as.data.frame(matrix(,20,3))
colnames(results) <- c("value", "scaling.factor", "type")
results[, 1] <- c(probs2,probs)
results[, 2] <- c(1:10,1:10)
x <- factor(c("bidirectional false positive",
rep("bidirectional power",9),
"unidirectional false positive",
rep("unidirectional power", 9)))
x <- factor(x, levels(x)[c(2,4,1,3)])
results[, 3] <- x
ggplot(results, aes(y=value, x=scaling.factor, group=type, colour=type, shape=type)) +
geom_hline(yintercept = .05, linetype="dashed") +
geom_point(stat="identity", size=4, alpha=.8) +
geom_line() +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5), legend.text=element_text(size=rel(0.6))) +
scale_size(range=c(1, 4)) +
xlab("scaling factor") +
ylab("percent significant") +
scale_colour_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c("#377eb8","#e41a1c","#0d0101","#0d0101")) +
scale_shape_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c(16,16,0,4))
# export at 6.5x4
library(ggplot2)
par(mfrow = c(1,1), mar = c(5,4,4,2) + .1)
load('../../results/UnidirectionalScalingAnalysisResults.RData')
probs <- vector()
for(i in 1:10){
probs[i] <- sum(scaling.uni.results[1:100, i] <= .05) / 100
}
x <- rep(1:10)
load('../../results/BidirectionalScalingAnalysisResults.RData')
y <- vector()
for(j in 1:10){
for(i in 1:100){
y[2 * (100 * (j - 1) + i - 1) + 1] <- as.numeric(gsub(",.*", "",scaling.bi.results[i,j]))
y[2 * (100 * (j - 1) + i - 1) + 2] <- as.numeric(substr(scaling.bi.results[i,j], (nchar(gsub(",.*", "",scaling.bi.results[i,j])) + 2),
nchar(scaling.bi.results[i,j])))
}
}
probs2 <- vector()
for(i in 1:10){
probs2[i] <- round(sum(y[(200 * (i - 1) + 1):(200 * i)] <= .025, na.rm = T) /
sum(!is.na(y[(200 * (i - 1) + 1):(200 * i)])),digits = 2)
}
results <- as.data.frame(matrix(,20,3))
colnames(results) <- c("value", "scaling.factor", "type")
results[, 1] <- c(probs2,probs)
results[, 2] <- c(1:10,1:10)
x <- factor(c("bidirectional false positive",
rep("bidirectional power",9),
"unidirectional false positive",
rep("unidirectional power", 9)))
x <- factor(x, levels(x)[c(2,4,1,3)])
results[, 3] <- x
ggplot(results, aes(y=value, x=scaling.factor, group=type, colour=type, shape=type)) +
geom_hline(yintercept = .05, linetype="dashed") +
geom_point(stat="identity", size=4, alpha=.8) +
geom_line() +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5), legend.text=element_text(size=rel(0.6))) +
scale_size(range=c(1, 4)) +
xlab("scaling factor") +
ylab("percent significant") +
scale_colour_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c("#377eb8","#e41a1c","#0d0101","#0d0101")) +
scale_shape_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c(16,16,0,4))
results <- as.data.frame(matrix(,20,3))
colnames(results) <- c("value", "scaling.factor", "type")
results[, 1] <- c(probs2,probs)
results[, 2] <- c(1:10,1:10)
results
library(ggplot2)
par(mfrow = c(1,1), mar = c(5,4,4,2) + .1)
load('../../results/UnidirectionalScalingAnalysisResults.RData')
probs <- vector()
for(i in 1:10){
probs[i] <- sum(scaling.uni.results[1:100, i] <= .05) / 100
}
x <- rep(1:10)
load('../../results/BidirectionalScalingAnalysisResults.RData')
y <- vector()
for(j in 1:10){
for(i in 1:100){
y[2 * (100 * (j - 1) + i - 1) + 1] <- as.numeric(gsub(",.*", "",scaling.bi.results[i,j]))
y[2 * (100 * (j - 1) + i - 1) + 2] <- as.numeric(substr(scaling.bi.results[i,j], (nchar(gsub(",.*", "",scaling.bi.results[i,j])) + 2),
nchar(scaling.bi.results[i,j])))
}
}
probs2 <- vector()
for(i in 1:10){
probs2[i] <- round(sum(y[(200 * (i - 1) + 1):(200 * i)] <= .025, na.rm = T) /
sum(!is.na(y[(200 * (i - 1) + 1):(200 * i)])),digits = 2)
}
results <- as.data.frame(matrix(,20,3))
colnames(results) <- c("value", "scaling.factor", "type")
results[, 1] <- c(probs2,probs)
results[, 2] <- c(1:10,1:10)
x <- factor(c("bidirectional false positive",
rep("bidirectional power",9),
"unidirectional false positive",
rep("unidirectional power", 9)))
x <- factor(x, levels(x)[c(2,4,1,3)])
results[, 3] <- x
ggplot(results, aes(y=value, x=scaling.factor, group=type, colour=type, shape=type)) +
geom_hline(yintercept = .05, linetype="dashed") +
geom_point(stat="identity", size=4, alpha=.8) +
geom_line() +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5), legend.text=element_text(size=rel(0.6))) +
scale_size(range=c(1, 4)) +
xlab("scaling factor") +
ylab("percent significant") +
scale_colour_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c("#377eb8","#e41a1c","#0d0101","#0d0101")) +
scale_shape_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c(16,16,0,4))
# export at 6.5x4
load('../../results/UnidirectionalTaxaFPResults.RData')
load('../../results/UnidirectionalTaxaPowerResults.RData')
x <- seq(from=20, to=200, by=20)
y <- vector()
x
for(i in 1:10){
y <- c(y, taxa.uni.power.results[1:100, i])
}
probs <- vector()
for(i in 1:10){
probs[i] <- sum(taxa.uni.power.results[1:100, i] <= .05)
}
probsfp <- vector()
for(i in 1:10){
probsfp[i] <- sum(taxa.uni.fp.results[1:100, i] <= .05)
}
probsfp
probs
load('../../results/BidirectionalTaxaPowerResults.RData')
load('../../results/BidirectionalTaxaFPResults.RData')
y <- vector()
for(i in 1:10){
for(j in 1:10){
for(i in 1:100){
y[2 * (100 * (j - 1) + i - 1) + 1] <- as.numeric(gsub(",.*", "",taxa.bi.power.results[i,j]))
y[2 * (100 * (j - 1) + i - 1) + 2] <- as.numeric(substr(taxa.bi.power.results[i,j], (nchar(gsub(",.*", "",taxa.bi.power.results[i,j])) + 2),
nchar(taxa.bi.power.results[i,j])))
}
}
}
y
biprobs <- vector()
for(i in 1:10){
biprobs[i] <-
round(100 * sum(y[(200 * (i - 1) + 1):(200 * i)] <= .025, na.rm = T) / sum(!is.na(y[(200 * (i - 1) + 1):(200 * i)])),
digits = 0)
}
biprobs
y <- vector()
for(i in 1:10){
for(j in 1:10){
for(i in 1:100){
y[2 * (100 * (j - 1) + i - 1) + 1] <- as.numeric(gsub(",.*", "",taxa.bi.fp.results[i,j]))
y[2 * (100 * (j - 1) + i - 1) + 2] <- as.numeric(substr(taxa.bi.fp.results[i,j], (nchar(gsub(",.*", "",taxa.bi.fp.results[i,j])) + 2),
nchar(taxa.bi.fp.results[i,j])))
}
}
}
biprobsfp <- vector()
for(i in 1:10){
biprobsfp[i] <- round(100 * sum(y[(200 * (i - 1) + 1):(200 * i)] <= .025, na.rm = T) /
sum(!is.na(y[(200 * (i - 1) + 1):(200 * i)])),
digits = 0)
}
biprobsfp
up <- probs/100
bp <- biprobs/100
ufp <- probsfp/100
bfp <- biprobsfp/100
results <- as.data.frame(matrix(,40,3))
colnames(results) <- c("value", "taxa.number", "type")
results[, 1] <- c(up,bp,ufp,bfp)
results[, 2] <- rep(c(20,40,60,80,100,120,140,160,180,200), 4)
x <- factor(c(rep("unidirectional power", 10),
rep("bidirectional power",10),
rep("unidirectional false positive",10),
rep("bidirectional false positive", 10)))
x <- factor(x, levels(x)[c(2,4,1,3)])
results[, 3] <- x
results
ggplot(results, aes(y=value, x=taxa.number, group=type, colour=type, shape=type)) +
geom_hline(yintercept = .05, linetype="dashed") +
geom_point(stat="identity", size=4, alpha=.8) +
geom_line() +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
text=element_text(family="sans", face="plain", color="#000000", size=15,
hjust=0.5, vjust=0.5), legend.text=element_text(size=rel(0.6))) +
scale_size(range=c(1, 4)) +
xlab("number of taxa") +
ylab("percent significant") +
scale_colour_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c("#377eb8","#e41a1c","#377eb8","#e41a1c")) +
scale_shape_manual(labels = c("bidirectional power",
"unidirectional power",
"bidirectional false positive",
"unidirectional false positive"),
values=c(16,16,1,1))
